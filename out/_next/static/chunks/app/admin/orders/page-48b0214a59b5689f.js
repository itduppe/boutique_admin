(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[798],{897:(e,t,a)=>{"use strict";a.d(t,{O:()=>n});var r=a(2115);let n=()=>{let[e,t]=(0,r.useState)(null);return{isOpen:null!==e,modalType:e,openModal:e=>t(e),closeModal:()=>t(null)}}},1418:(e,t,a)=>{"use strict";a.d(t,{N0:()=>r});let r=()=>localStorage.getItem("site-system")},1868:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});let r={endpoint_789bet:"https://api-duatop78win.attcloud.org",endpoint_f168:"https://api-duatop78win.attcloud.org",system:{system01:"789bet",system02:"f168"},product_tag:{in_stock:"C\xf2n h\xe0ng",out_of_stock:"Hết h\xe0ng",hot:"Hot",upcoming:"Sắp ra mắt"},product_type:{fashion:"Sản phẩm thời trang",entertainment:"Sản phẩm truyền th\xf4ng",giftcode:"Q\xf9a tặng code",charity:"Từ thiện"},product_type_register:{point:"Đăng k\xfd theo điểm",manual:"Đăng k\xfd thủ c\xf4ng",donate:"Từ thiện",telegram:"Telegram"},type_message:{deny:"Th\xf4ng b\xe1o từ chối",allow:"Th\xf4ng b\xe1o th\xe0nh c\xf4ng"},role:{user:"User ( Người d\xf9ng )",admin:"Admin ( Quản trị vi\xean )"},order_status:{pending:"X\xe1c nhận hợp lệ",confirm:"Gửi thư",deny:"Từ chối",shipped:"Gửi giao h\xe0ng",success:"Ho\xe0n tất giao h\xe0ng",refund:"sản phẩm được trả lại sau khi giao h\xe0ng"}}},2241:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});var r=a(5155);a(2115);var n=a(9688);let s=e=>{let{htmlFor:t,children:a,className:s}=e;return(0,r.jsx)("label",{htmlFor:t,className:(0,n.QP)("mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400",s),children:a})}},5152:(e,t,a)=>{"use strict";a.d(t,{A:()=>l});var r=a(3464),n=a(7383);let s=r.A.create({baseURL:"https://api-quatangv2-f168.attcloud.work/api",headers:{"Content-Type":"application/json"}});{let e=n.A.get("token");e&&(s.defaults.headers.Authorization="Bearer ".concat(e))}let l=s},5642:(e,t,a)=>{Promise.resolve().then(a.bind(a,7367))},6842:(e,t,a)=>{"use strict";a.d(t,{A0:()=>s,BF:()=>l,Hj:()=>d,XI:()=>n,nA:()=>i});var r=a(5155);a(2115);let n=e=>{let{children:t,className:a}=e;return(0,r.jsx)("table",{className:"min-w-full  ".concat(a),children:t})},s=e=>{let{children:t,className:a}=e;return(0,r.jsx)("thead",{className:a,children:t})},l=e=>{let{children:t,className:a}=e;return(0,r.jsx)("tbody",{className:a,children:t})},d=e=>{let{children:t,className:a}=e;return(0,r.jsx)("tr",{className:a,children:t})},i=e=>{let{children:t,isHeader:a=!1,className:n}=e;return(0,r.jsx)(a?"th":"td",{className:" ".concat(n),children:t})}},7367:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>f});var r=a(5155),n=a(2115),s=a(8543),l=a(6842),d=a(897),i=a(5152);let c=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Đ\xe3 xảy ra lỗi";throw console.error(t,e),s.oR.error(t),e},o={getAll:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{let{items:t,statusCount:a,total:r,page:n,pageSize:s,totalPages:l}=(await i.A.get("/orders",{params:e})).data.data;return{data:t,statusCount:a,total:r,page:n,pageSize:s,totalPages:l}}catch(e){return c(e,"Lỗi khi lấy danh s\xe1ch đơn h\xe0ng")}},getExport:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{return(await i.A.get("/orders/export",{params:e,responseType:"blob"})).data}catch(e){return c(e,"Lỗi khi xuất file Excel")}},updateStatusById:async e=>{try{let t=await i.A.patch("/orders/update-status/",e);return s.oR.success("Đổi th\xf4ng tin th\xe0nh c\xf4ng!"),t.data}catch(e){return c(e,"Lỗi khi đổi th\xf4ng tin")}},delete:async e=>{try{let t=await i.A.delete("/orders/".concat(e));return s.oR.success("X\xf3a đơn h\xe0ng th\xe0nh c\xf4ng!"),t.data}catch(e){return c(e,"Lỗi khi x\xf3a đơn h\xe0ng")}}};var u=a(1418),h=a(1868),m=a(2125);a(5371);var g=a(2241),x=a(9805);function p(e){let{id:t,mode:a="single",onChange:s,defaultDate:l,value:d,label:i,placeholder:c}=e,o=(0,n.useRef)(null);return(0,n.useEffect)(()=>{if(!o.current)return;let e=(0,m.A)(o.current,{mode:a,static:!0,dateFormat:"Y-m-d",defaultDate:l||d||void 0,onChange:s});return()=>{e&&e.destroy()}},[a,s,l,d]),(0,r.jsxs)("div",{children:[i&&(0,r.jsx)(g.A,{htmlFor:t,children:i}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("input",{ref:o,id:t,value:d||"",readOnly:!0,placeholder:c,className:"h-11 w-full rounded-lg border appearance-none px-4 py-2.5 text-sm shadow-theme-xs placeholder:text-gray-400 focus:outline-hidden focus:ring-3 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30 bg-transparent text-gray-800 border-gray-300 focus:border-brand-300 focus:ring-brand-500/20 dark:border-gray-700 dark:focus:border-brand-800"}),(0,r.jsx)("span",{className:"absolute text-gray-500 -translate-y-1/2 pointer-events-none right-3 top-1/2 dark:text-gray-400",children:(0,r.jsx)(x.e$,{className:"size-6"})})]})]})}let b={product_id:"",title:"",content:"",note:"",type_message:"",site:(0,u.N0)(),created_by:"ADMIN"};function y(){let[e,t]=(0,n.useState)([]),[a,i]=(0,n.useState)({allSuccess:0,allPending:0,allConfirm:0,allShipped:0,allDeny:0}),[c,m]=(0,n.useState)(1),[g,x]=(0,n.useState)(10),{isOpen:y,modalType:f,openModal:j,closeModal:v}=(0,d.O)(),[N,k]=(0,n.useState)(b),[w,_]=(0,n.useState)(""),[S,A]=(0,n.useState)(!1),[C,T]=(0,n.useState)({from_date:"",to_date:"",username:"",phone_number:"",address:"",full_name:"",product_id:"",status:"",page:1,pageSize:10}),E=(0,n.useRef)({}),[L,R]=(0,n.useState)(null),D=Math.ceil(g/C.pageSize),z=(c-1)*g,F=e.slice(z,z+g);(0,n.useEffect)(()=>{y&&_("")},[y,f]);let O=async e=>{try{await o.delete(e),M()}catch(e){_("X\xf3a b\xecnh luận thất bại. Vui l\xf2ng kiểm tra th\xf4ng tin.")}},H=async()=>{let{username:e,phone_number:t,address:a,full_name:r,product_id:n,from_date:s,to_date:l,status:d,page:i,pageSize:c}=C,o={...e&&{username:e},...t&&{phone_number:t},...a&&{address:a},...r&&{full_name:r},...n&&{product_id:n},...s&&{from_date:s},...l&&{to_date:l},...d&&{status:d},page:i,pageSize:c,site:(0,u.N0)()};await M(o)},I=async()=>{try{let{username:e,phone_number:t,address:a,full_name:r,product_id:n,from_date:s,to_date:l,status:d,pageSize:i}=C,c={...e&&{username:e},...t&&{phone_number:t},...a&&{address:a},...r&&{full_name:r},...n&&{product_id:n},...s&&{from_date:s},...l&&{to_date:l},...d&&{status:d},pageSize:i||1e3,site:(0,u.N0)()},h=await o.getExport(c),m=window.URL.createObjectURL(new Blob([h])),g=document.createElement("a");g.href=m,g.setAttribute("download","orders_export.xlsx"),document.body.appendChild(g),g.click(),g.remove(),window.URL.revokeObjectURL(m)}catch(t){let e=t instanceof Error?t.message:"Xuất Excel thất bại";s.oR.error(e)}},M=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{let a={site:(0,u.N0)(),...e},r=await o.getAll(a);t(r.data),i(r.statusCount),m(r.page),x(r.total)}catch(e){s.oR.error("Danh s\xe1ch b\xecnh luận bị lỗi !")}},U=async e=>{try{let t=await o.updateStatusById(e);200==t.status_code?(v(),H(),R(null)):s.oR.error(t.message)}catch(e){_("Thao t\xe1c thất bại. Vui l\xf2ng kiểm tra th\xf4ng tin.")}finally{A(!1)}};return(0,n.useEffect)(()=>{M()},[]),(0,n.useEffect)(()=>{H()},[C]),(0,n.useEffect)(()=>{let e=e=>{if(null===L)return;let t=E.current[L];t&&!t.contains(e.target)&&R(null)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[L]),(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{className:"overflow-hidden rounded-xl border border-gray-200 bg-white dark:border-white/[0.05] dark:bg-white/[0.03]",children:[(0,r.jsxs)("div",{className:"m-5 flex items-center",children:[(0,r.jsx)("div",{className:"text-2xl",children:"Quản l\xfd đơn h\xe0ng | "}),Object.entries(h.Z.order_status).map(e=>{let[t,n]=e;return(0,r.jsxs)("button",{onClick:()=>T(e=>({...e,status:t,page:1})),className:"block text-md px-4 py-2 text-left text-gray-700 hover:bg-gray-100 rounded ".concat(C.status===t?"bg-blue-500 text-white":""),children:[n," "," ","success"===t&&"(".concat(a.allSuccess,")"),"pending"===t&&"(".concat(a.allPending,")"),"confirm"===t&&"(".concat(a.allConfirm,")"),"shipped"===t&&"(".concat(a.allShipped,")"),"deny"===t&&"(".concat(a.allDeny,")")]},t)})]}),(0,r.jsxs)("div",{className:"w-full flex justify-end",children:[(0,r.jsx)("button",{onClick:()=>j("add"),type:"button",className:"focus:outline-none text-white bg-green-700 hover:bg-green-800 focus:ring-4 focus:ring-green-300 font-medium rounded-lg text-sm px-5 py-2.5 me-2 mb-2 dark:bg-green-600 dark:hover:bg-green-700 dark:focus:ring-green-800",children:"X\xf3a nhiều order"}),(0,r.jsx)("button",{type:"button",onClick:I,className:"focus:outline-none text-white bg-green-700 hover:bg-green-800 focus:ring-4 focus:ring-green-300 font-medium rounded-lg text-sm px-5 py-2.5 me-2 mb-2 dark:bg-green-600 dark:hover:bg-green-700 dark:focus:ring-green-800",children:"Export Order"})]}),(0,r.jsx)("div",{className:"m-5 flex justify-between",children:(0,r.jsx)("div",{className:"w-full pb-10",children:(0,r.jsxs)("div",{className:"flex flex-wrap gap-5 mb-4",children:[(0,r.jsxs)("div",{className:"w-[18.6%]",children:[(0,r.jsx)("label",{htmlFor:"username",className:"sr-only",children:"T\xean T\xe0i khoản"}),(0,r.jsx)("div",{className:"relative w-full",children:(0,r.jsx)("input",{id:"username",name:"username",type:"text",value:C.username,onChange:e=>T({...C,username:e.target.value}),className:"border border-gray-300 text-black text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full pl-2.5 p-2.5",placeholder:"T\xean T\xe0i khoản"})})]}),(0,r.jsxs)("div",{className:"w-[18.6%]",children:[(0,r.jsx)("label",{htmlFor:"phone_number",className:"sr-only",children:"Số điện thoại"}),(0,r.jsx)("div",{className:"relative w-full",children:(0,r.jsx)("input",{id:"phone_number",name:"phone_number",type:"text",value:C.phone_number,onChange:e=>T({...C,phone_number:e.target.value}),className:"border border-gray-300 text-black text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full pl-2.5 p-2.5",placeholder:"Số điện thoại"})})]}),(0,r.jsxs)("div",{className:"w-[18.6%]",children:[(0,r.jsx)("label",{htmlFor:"address",className:"sr-only",children:"Địa Chỉ"}),(0,r.jsx)("div",{className:"relative w-full",children:(0,r.jsx)("input",{id:"address",name:"address",type:"text",value:C.address,onChange:e=>T({...C,address:e.target.value}),className:"border border-gray-300 text-black text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full pl-2.5 p-2.5",placeholder:"Địa Chỉ"})})]}),(0,r.jsxs)("div",{className:"w-[18.6%]",children:[(0,r.jsx)("label",{htmlFor:"full_name",className:"sr-only",children:"T\xean đầy đủ"}),(0,r.jsx)("div",{className:"relative w-full",children:(0,r.jsx)("input",{id:"full_name",name:"full_name",type:"text",value:C.full_name,onChange:e=>T({...C,full_name:e.target.value}),className:"border border-gray-300 text-black text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full pl-2.5 p-2.5",placeholder:"T\xean đầy đủ"})})]}),(0,r.jsxs)("div",{className:"w-[18.6%]",children:[(0,r.jsx)("label",{htmlFor:"product_id",className:"sr-only",children:"ID sản phẩm"}),(0,r.jsx)("div",{className:"relative w-full",children:(0,r.jsx)("input",{id:"product_id",name:"product_id",type:"text",value:C.product_id,onChange:e=>T({...C,product_id:e.target.value}),className:"border border-gray-300 text-black text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full pl-2.5 p-2.5",placeholder:"ID sản phẩm"})})]}),(0,r.jsx)("div",{className:"w-[18.6%]",children:(0,r.jsx)(p,{id:"date-picker",label:"Ng\xe0y bắt đầu",value:C.from_date,onChange:(e,t)=>{T({...C,from_date:t})},placeholder:"Chọn ng\xe0y bắt đầu"})}),(0,r.jsx)("div",{className:"w-[18.6%]",children:(0,r.jsx)(p,{id:"date-picker",label:"Ng\xe0y kết th\xfac",value:C.to_date,onChange:(e,t)=>{T({...C,to_date:t})},placeholder:"Chọn ng\xe0y kết th\xfac"})}),(0,r.jsx)("div",{className:"w-[18.6%] mt-7",children:(0,r.jsxs)("button",{onClick:e=>{e.preventDefault(),H()},type:"submit",className:"h-auto p-2.5 ms-2 text-sm font-medium text-white bg-blue-700 rounded-lg border border-blue-700 hover:bg-blue-800",children:[(0,r.jsx)("svg",{className:"w-4 h-4","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 20 20",children:(0,r.jsx)("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"m19 19-4-4m0-7A7 7 0 1 1 1 8a7 7 0 0 1 14 0Z"})}),(0,r.jsx)("span",{className:"sr-only",children:"Search"})]})})]})})}),(0,r.jsx)("div",{className:"max-w-full overflow-x-auto",children:(0,r.jsxs)("div",{className:"min-w-[1102px]",children:[(0,r.jsxs)(l.XI,{children:[(0,r.jsx)(l.A0,{className:"border-b border-gray-100 dark:border-white/[0.05]",children:(0,r.jsx)(l.Hj,{children:["STT","Sản phẩm","T\xe0i khoản","T\xean người nhận","Điện thoại","Địa chỉ","TG Đăng K\xfd","IP","Trạng Th\xe1i","H\xe0nh Động"].map((e,t)=>(0,r.jsx)(l.nA,{isHeader:!0,className:"px-5 py-3 font-medium text-gray-500 ".concat("H\xe0nh Động"===e?"text-center":"text-start"," text-theme-xs dark:text-gray-400"),children:e},t))})}),(0,r.jsx)(l.BF,{className:"divide-y divide-gray-100 dark:divide-white/[0.05]",children:F.map((e,t)=>(0,r.jsxs)(l.Hj,{children:[(0,r.jsx)(l.nA,{className:"px-5 py-4 sm:px-6 text-start",children:t+1}),(0,r.jsxs)(l.nA,{className:"px-4 py-3 text-gray-500 text-start text-theme-sm dark:text-gray-400",children:["M\xe3 sản phẩm: ",e.product_id," ",(0,r.jsx)("br",{}),e.product_name," ",(0,r.jsx)("br",{}),"M\xe0u: ",e.color," ",(0,r.jsx)("br",{}),"Size: ",e.size," ",(0,r.jsx)("br",{})]}),(0,r.jsx)(l.nA,{className:"px-4 py-3 text-gray-500 text-start text-theme-sm dark:text-gray-400",children:e.username}),(0,r.jsx)(l.nA,{className:"px-4 py-3 text-gray-500 text-start text-theme-sm dark:text-gray-400",children:e.full_name}),(0,r.jsx)(l.nA,{className:"px-4 py-3 text-gray-500 text-theme-sm dark:text-gray-400",children:e.phone_number}),(0,r.jsx)(l.nA,{className:"px-4 py-3 text-gray-500 text-theme-sm dark:text-gray-400",children:e.address}),(0,r.jsx)(l.nA,{className:"px-4 py-3 text-gray-500 text-start text-theme-sm dark:text-gray-400",children:new Date(e.createdAt).toLocaleDateString("vi-VN",{timeZone:"UTC"})}),(0,r.jsx)(l.nA,{className:"px-4 py-3 text-gray-500 text-theme-sm dark:text-gray-400",children:new Date(e.updatedAt).toLocaleDateString("vi-VN",{timeZone:"UTC"})}),(0,r.jsx)(l.nA,{className:"px-4 py-3 text-gray-500 text-theme-sm dark:text-gray-400",children:e.status}),(0,r.jsx)(l.nA,{className:"px-4 py-3 text-gray-500 text-theme-sm dark:text-gray-400 relative",children:(0,r.jsxs)("div",{className:"flex justify-center items-center gap-2",children:[(0,r.jsxs)("div",{className:"relative inline-block text-left",children:[(0,r.jsx)("button",{onClick:()=>R(e._id),type:"button",className:"inline-flex justify-center w-full rounded-md bg-blue-700 px-4 py-2 text-sm font-medium text-white hover:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-blue-500",children:"Sửa trạng th\xe1i"}),L===e._id&&(0,r.jsx)("div",{className:"absolute right-0 z-20 mt-2 w-40 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none",ref:t=>{E.current[e._id]=t},children:(0,r.jsx)("div",{className:"py-1",children:Object.entries(h.Z.order_status).map(t=>{let[a,n]=t;return(0,r.jsx)("button",{onClick:()=>U({status:a,id:e._id}),className:"block w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-100",children:n},a)})})})]}),(0,r.jsx)("button",{onClick:()=>O(e._id),type:"button",className:"text-white bg-red-700 hover:bg-red-800 focus:ring-4 focus:ring-red-300 font-medium rounded-lg text-sm px-4 py-2 dark:bg-red-600 dark:hover:bg-red-700 focus:outline-none dark:focus:ring-red-800",children:"X\xf3a"})]})})]},t))})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between p-5",children:[(0,r.jsxs)("select",{name:"pageSize",value:C.pageSize,onChange:e=>{let t=Number(e.target.value);T(e=>({...e,pageSize:t,page:1}))},className:"h-10 w-30 appearance-none rounded-lg border border-gray-300 px-4 py-1",children:[(0,r.jsx)("option",{value:"10",children:"10 / page"}),(0,r.jsx)("option",{value:"20",children:"20 / page"}),(0,r.jsx)("option",{value:"50",children:"50 / page"}),(0,r.jsx)("option",{value:"100",children:"100 / page"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2 mt-4",children:[(0,r.jsx)("button",{onClick:()=>T(e=>({...e,page:Math.max(e.page-1,1)})),disabled:1===C.page,className:"px-3 py-1 border rounded disabled:opacity-50",children:"← Trước"}),Array.from({length:D},(e,t)=>(0,r.jsx)("button",{onClick:()=>T(e=>({...e,page:t+1})),className:"px-3 py-1 border rounded ".concat(C.page===t+1?"bg-blue-500 text-white":""),children:t+1},t)),(0,r.jsx)("button",{onClick:()=>T(e=>({...e,page:Math.min(e.page+1,D)})),disabled:C.page===D,className:"px-3 py-1 border rounded disabled:opacity-50",children:"Sau →"})]})]})]})})]})})}let f=()=>(0,r.jsx)("div",{children:(0,r.jsx)(y,{})})}},e=>{var t=t=>e(e.s=t);e.O(0,[474,49,464,688,623,805,441,684,358],()=>t(5642)),_N_E=e.O()}]);