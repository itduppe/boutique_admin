(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[798],{28:(e,t,r)=>{"use strict";function a(e){if(!e)return"";try{return new Date(e).toLocaleString("vi-VN",{timeZone:"Asia/Ho_Chi_Minh",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1})}catch(t){return console.error("Invalid date:",e),""}}function n(e){return new Date(e.getTime()+6e4*e.getTimezoneOffset()+252e5)}r.d(t,{R:()=>a,S:()=>n})},897:(e,t,r)=>{"use strict";r.d(t,{O:()=>n});var a=r(2115);let n=()=>{let[e,t]=(0,a.useState)(null);return{isOpen:null!==e,modalType:e,openModal:e=>t(e),closeModal:()=>t(null)}}},1418:(e,t,r)=>{"use strict";r.d(t,{N0:()=>a});let a=()=>localStorage.getItem("site-system")},1868:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});let a={endpoint_789bet:"https://api-duatop78win.attcloud.org",endpoint_f168:"https://api-duatop78win.attcloud.org",system:{system01:"789bet",system02:"f168"},product_tag:{in_stock:"C\xf2n h\xe0ng",out_of_stock:"Hết h\xe0ng",hot:"Hot",upcoming:"Sắp ra mắt"},product_type:{fashion:"Sản phẩm thời trang",entertainment:"Sản phẩm truyền th\xf4ng",giftcode:"Q\xf9a tặng code",charity:"Từ thiện"},product_type_register:{point:"Đăng k\xfd theo điểm",manual:"Đăng k\xfd theo điều kiện",donate:"Từ thiện",telegram:"Telegram"},type_message:{deny:"Th\xf4ng b\xe1o từ chối",allow:"Th\xf4ng b\xe1o th\xe0nh c\xf4ng"},role:{user:"User ( Người d\xf9ng )",admin:"Admin ( Quản trị vi\xean )",superadmin:"Supper Admin ( Quản trị vi\xean )"},order_status:{pending:"Chờ x\xe1c nhận",confirm:"Gửi thư",deny:"Từ chối",shipped:"Gửi giao h\xe0ng",success:"Ho\xe0n tất giao h\xe0ng",refund:"sản phẩm được trả lại sau khi giao h\xe0ng"}}},2241:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var a=r(5155);r(2115);var n=r(9688);let s=e=>{let{htmlFor:t,children:r,className:s}=e;return(0,a.jsx)("label",{htmlFor:t,className:(0,n.QP)("mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400",s),children:r})}},5152:(e,t,r)=>{"use strict";r.d(t,{A:()=>l});var a=r(3464),n=r(7383);let s=a.A.create({baseURL:"https://api-quatangv2-f168.attcloud.work/api",headers:{"Content-Type":"application/json"}});{let e=n.A.get("token");e&&(s.defaults.headers.Authorization="Bearer ".concat(e))}let l=s},5642:(e,t,r)=>{Promise.resolve().then(r.bind(r,7367))},6842:(e,t,r)=>{"use strict";r.d(t,{A0:()=>s,BF:()=>l,Hj:()=>i,XI:()=>n,nA:()=>d});var a=r(5155);r(2115);let n=e=>{let{children:t,className:r}=e;return(0,a.jsx)("table",{className:"min-w-full  ".concat(r),children:t})},s=e=>{let{children:t,className:r}=e;return(0,a.jsx)("thead",{className:r,children:t})},l=e=>{let{children:t,className:r}=e;return(0,a.jsx)("tbody",{className:r,children:t})},i=e=>{let{children:t,className:r}=e;return(0,a.jsx)("tr",{className:r,children:t})},d=e=>{let{children:t,isHeader:r=!1,className:n}=e;return(0,a.jsx)(r?"th":"td",{className:" ".concat(n),children:t})}},7367:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>j});var a=r(5155),n=r(2115),s=r(8543),l=r(6842),i=r(897),d=r(5152);let c=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Đ\xe3 xảy ra lỗi";throw console.error(t,e),s.oR.error(t),e},o={getAll:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{let{items:t,statusCount:r,total:a,page:n,pageSize:s,totalPages:l}=(await d.A.get("/orders",{params:e})).data.data;return{data:t,statusCount:r,total:a,page:n,pageSize:s,totalPages:l}}catch(e){return c(e,"Lỗi khi lấy danh s\xe1ch đơn h\xe0ng")}},getExport:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{return(await d.A.get("/orders/export",{params:e,responseType:"blob"})).data}catch(e){return c(e,"Lỗi khi xuất file Excel")}},updateStatusById:async e=>{try{let t=await d.A.patch("/orders/update-status/",e);return s.oR.success("Đổi th\xf4ng tin th\xe0nh c\xf4ng!"),t.data}catch(e){return c(e,"Lỗi khi đổi th\xf4ng tin")}},delete:async e=>{try{let t=await d.A.delete("/orders/".concat(e));return s.oR.success("X\xf3a đơn h\xe0ng th\xe0nh c\xf4ng!"),t.data}catch(e){return c(e,"Lỗi khi x\xf3a đơn h\xe0ng")}}};var u=r(1418),h=r(1868),m=r(2125);r(5371);var g=r(2241),x=r(9805);function p(e){let{id:t,mode:r="single",onChange:s,defaultDate:l,value:i,label:d,placeholder:c}=e,o=(0,n.useRef)(null);return(0,n.useEffect)(()=>{if(!o.current)return;let e=(0,m.A)(o.current,{mode:r,static:!0,dateFormat:"Y-m-d",defaultDate:l||i||void 0,onChange:s});return()=>{e&&e.destroy()}},[r,s,l,i]),(0,a.jsxs)("div",{children:[d&&(0,a.jsx)(g.A,{htmlFor:t,children:d}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{ref:o,id:t,value:i||"",readOnly:!0,placeholder:c,className:"h-11 w-full rounded-lg border appearance-none px-4 py-2.5 text-sm shadow-theme-xs placeholder:text-gray-400 focus:outline-hidden focus:ring-3 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30 bg-transparent text-gray-800 border-gray-300 focus:border-brand-300 focus:ring-brand-500/20 dark:border-gray-700 dark:focus:border-brand-800"}),(0,a.jsx)("span",{className:"absolute text-gray-500 -translate-y-1/2 pointer-events-none right-3 top-1/2 dark:text-gray-400",children:(0,a.jsx)(x.e$,{className:"size-6"})})]})]})}var b=r(28);let y={product_id:"",title:"",content:"",note:"",type_message:"",site:(0,u.N0)(),created_by:"ADMIN"};function f(){let[e,t]=(0,n.useState)([]),[r,d]=(0,n.useState)({allSuccess:0,allPending:0,allConfirm:0,allShipped:0,allDeny:0}),[c,m]=(0,n.useState)(1),[g,x]=(0,n.useState)(10),{isOpen:f,modalType:j,openModal:v,closeModal:N}=(0,i.O)(),[k,w]=(0,n.useState)(y),[_,S]=(0,n.useState)(""),[A,C]=(0,n.useState)(!1),[T,E]=(0,n.useState)({from_date:"",to_date:"",username:"",phone_number:"",address:"",full_name:"",product_id:"",status:"",page:1,pageSize:10}),R=(0,n.useRef)({}),[L,O]=(0,n.useState)(null),[z,F]=(0,n.useState)(0),D=Math.ceil(z/T.pageSize),H=(c-1)*g,I=e.slice(H,H+g);(0,n.useEffect)(()=>{f&&S("")},[f,j]);let M=async e=>{try{await o.delete(e),U()}catch(e){S("X\xf3a b\xecnh luận thất bại. Vui l\xf2ng kiểm tra th\xf4ng tin.")}},X=async()=>{let{username:e,phone_number:t,address:r,full_name:a,product_id:n,from_date:s,to_date:l,status:i,page:d,pageSize:c}=T,o={...e&&{username:e},...t&&{phone_number:t},...r&&{address:r},...a&&{full_name:a},...n&&{product_id:n},...s&&{from_date:s},...l&&{to_date:l},...i&&{status:i},page:d,pageSize:c,site:(0,u.N0)()};await U(o)},B=async()=>{try{let{username:e,phone_number:t,address:r,full_name:a,product_id:n,from_date:s,to_date:l,status:i,pageSize:d}=T,c={...e&&{username:e},...t&&{phone_number:t},...r&&{address:r},...a&&{full_name:a},...n&&{product_id:n},...s&&{from_date:s},...l&&{to_date:l},...i&&{status:i},pageSize:d||1e3,site:(0,u.N0)()},h=await o.getExport(c),m=window.URL.createObjectURL(new Blob([h])),g=document.createElement("a");g.href=m,g.setAttribute("download","orders_export.xlsx"),document.body.appendChild(g),g.click(),g.remove(),window.URL.revokeObjectURL(m)}catch(t){let e=t instanceof Error?t.message:"Xuất Excel thất bại";s.oR.error(e)}},U=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{let r={site:(0,u.N0)(),...e},a=await o.getAll(r);t(a.data),F(a.total)}catch(e){s.oR.error("Danh s\xe1ch lỗi !")}},Z=async e=>{try{let t=await o.updateStatusById(e);200==t.status_code?(N(),X(),O(null)):s.oR.error(t.message)}catch(e){S("Thao t\xe1c thất bại. Vui l\xf2ng kiểm tra th\xf4ng tin.")}finally{C(!1)}};return(0,n.useEffect)(()=>{U()},[]),(0,n.useEffect)(()=>{X()},[T]),(0,n.useEffect)(()=>{let e=e=>{if(null===L)return;let t=R.current[L];t&&!t.contains(e.target)&&O(null)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[L]),(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"overflow-hidden rounded-xl border border-gray-200 bg-white dark:border-white/[0.05] dark:bg-white/[0.03] !min-h-[80vh]",children:[(0,a.jsxs)("div",{className:"m-5 flex items-center",children:[(0,a.jsx)("div",{className:"text-2xl",children:"Quản l\xfd đơn h\xe0ng | "}),Object.entries(h.Z.order_status).map(e=>{let[t,n]=e;return(0,a.jsxs)("button",{onClick:()=>E(e=>({...e,status:t,page:1})),className:"block text-md px-4 py-2 text-left text-gray-700 hover:bg-gray-100 rounded ".concat(T.status===t?"bg-blue-500 text-white":""),children:[n," "," ","success"===t&&"(".concat(r.allSuccess,")"),"pending"===t&&"(".concat(r.allPending,")"),"confirm"===t&&"(".concat(r.allConfirm,")"),"shipped"===t&&"(".concat(r.allShipped,")"),"deny"===t&&"(".concat(r.allDeny,")")]},t)})]}),(0,a.jsxs)("div",{className:"w-full flex justify-end",children:[(0,a.jsx)("button",{onClick:()=>v("add"),type:"button",className:"focus:outline-none text-white bg-green-700 hover:bg-green-800 focus:ring-4 focus:ring-green-300 font-medium rounded-lg text-sm px-5 py-2.5 me-2 mb-2 dark:bg-green-600 dark:hover:bg-green-700 dark:focus:ring-green-800",children:"X\xf3a nhiều order"}),(0,a.jsx)("button",{type:"button",onClick:B,className:"focus:outline-none text-white bg-green-700 hover:bg-green-800 focus:ring-4 focus:ring-green-300 font-medium rounded-lg text-sm px-5 py-2.5 me-2 mb-2 dark:bg-green-600 dark:hover:bg-green-700 dark:focus:ring-green-800",children:"Export Order"})]}),(0,a.jsx)("div",{className:"m-5 flex justify-between",children:(0,a.jsx)("div",{className:"w-full pb-10",children:(0,a.jsxs)("div",{className:"flex flex-wrap gap-5 mb-4",children:[(0,a.jsxs)("div",{className:"w-[18.6%]",children:[(0,a.jsx)("label",{htmlFor:"username",className:"sr-only",children:"T\xean T\xe0i khoản"}),(0,a.jsx)("div",{className:"relative w-full",children:(0,a.jsx)("input",{id:"username",name:"username",type:"text",value:T.username,onChange:e=>E({...T,username:e.target.value}),className:"border border-gray-300 text-black text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full pl-2.5 p-2.5",placeholder:"T\xean T\xe0i khoản"})})]}),(0,a.jsxs)("div",{className:"w-[18.6%]",children:[(0,a.jsx)("label",{htmlFor:"phone_number",className:"sr-only",children:"Số điện thoại"}),(0,a.jsx)("div",{className:"relative w-full",children:(0,a.jsx)("input",{id:"phone_number",name:"phone_number",type:"text",value:T.phone_number,onChange:e=>E({...T,phone_number:e.target.value}),className:"border border-gray-300 text-black text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full pl-2.5 p-2.5",placeholder:"Số điện thoại"})})]}),(0,a.jsxs)("div",{className:"w-[18.6%]",children:[(0,a.jsx)("label",{htmlFor:"address",className:"sr-only",children:"Địa Chỉ"}),(0,a.jsx)("div",{className:"relative w-full",children:(0,a.jsx)("input",{id:"address",name:"address",type:"text",value:T.address,onChange:e=>E({...T,address:e.target.value}),className:"border border-gray-300 text-black text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full pl-2.5 p-2.5",placeholder:"Địa Chỉ"})})]}),(0,a.jsxs)("div",{className:"w-[18.6%]",children:[(0,a.jsx)("label",{htmlFor:"full_name",className:"sr-only",children:"T\xean đầy đủ"}),(0,a.jsx)("div",{className:"relative w-full",children:(0,a.jsx)("input",{id:"full_name",name:"full_name",type:"text",value:T.full_name,onChange:e=>E({...T,full_name:e.target.value}),className:"border border-gray-300 text-black text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full pl-2.5 p-2.5",placeholder:"T\xean đầy đủ"})})]}),(0,a.jsxs)("div",{className:"w-[18.6%]",children:[(0,a.jsx)("label",{htmlFor:"product_id",className:"sr-only",children:"ID sản phẩm"}),(0,a.jsx)("div",{className:"relative w-full",children:(0,a.jsx)("input",{id:"product_id",name:"product_id",type:"text",value:T.product_id,onChange:e=>E({...T,product_id:e.target.value}),className:"border border-gray-300 text-black text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full pl-2.5 p-2.5",placeholder:"ID sản phẩm"})})]}),(0,a.jsx)("div",{className:"w-[18.6%]",children:(0,a.jsx)(p,{id:"date-picker",label:"Ng\xe0y bắt đầu",value:T.from_date,onChange:(e,t)=>{E({...T,from_date:t})},placeholder:"Chọn ng\xe0y bắt đầu"})}),(0,a.jsx)("div",{className:"w-[18.6%]",children:(0,a.jsx)(p,{id:"date-picker",label:"Ng\xe0y kết th\xfac",value:T.to_date,onChange:(e,t)=>{E({...T,to_date:t})},placeholder:"Chọn ng\xe0y kết th\xfac"})}),(0,a.jsx)("div",{className:"w-[18.6%] mt-7",children:(0,a.jsxs)("button",{onClick:e=>{e.preventDefault(),X()},type:"submit",className:"h-auto p-2.5 ms-2 text-sm font-medium text-white bg-blue-700 rounded-lg border border-blue-700 hover:bg-blue-800",children:[(0,a.jsx)("svg",{className:"w-4 h-4","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 20 20",children:(0,a.jsx)("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"m19 19-4-4m0-7A7 7 0 1 1 1 8a7 7 0 0 1 14 0Z"})}),(0,a.jsx)("span",{className:"sr-only",children:"Search"})]})})]})})}),(0,a.jsx)("div",{className:"max-w-full overflow-x-auto",children:(0,a.jsxs)("div",{className:"min-w-[1102px]",children:[(0,a.jsxs)(l.XI,{children:[(0,a.jsx)(l.A0,{className:"border-b border-gray-100 dark:border-white/[0.05]",children:(0,a.jsx)(l.Hj,{children:["STT","Sản phẩm","T\xe0i khoản","T\xean người nhận","Điện thoại","Địa chỉ","TG Đăng K\xfd","TG X\xe1c nhận","IP","Trạng Th\xe1i","H\xe0nh Động"].map((e,t)=>(0,a.jsx)(l.nA,{isHeader:!0,className:"px-5 py-3 font-medium text-gray-500 ".concat("H\xe0nh Động"===e?"text-center":"text-start"," text-theme-xs dark:text-gray-400"),children:e},t))})}),(0,a.jsx)(l.BF,{className:"divide-y divide-gray-100 dark:divide-white/[0.05]",children:I.map((e,t)=>(0,a.jsxs)(l.Hj,{children:[(0,a.jsx)(l.nA,{className:"px-5 py-4 sm:px-6 text-start",children:t+1}),(0,a.jsxs)(l.nA,{className:"px-4 py-3 text-gray-500 text-start text-theme-sm dark:text-gray-400",children:["M\xe3 sản phẩm: ",e.product_id," ",(0,a.jsx)("br",{}),e.product_name," ",(0,a.jsx)("br",{}),"M\xe0u: ",e.color," ",(0,a.jsx)("br",{}),"Size: ",e.size," ",(0,a.jsx)("br",{})]}),(0,a.jsx)(l.nA,{className:"px-4 py-3 text-gray-500 text-start text-theme-sm dark:text-gray-400",children:e.username}),(0,a.jsx)(l.nA,{className:"px-4 py-3 text-gray-500 text-start text-theme-sm dark:text-gray-400",children:e.full_name}),(0,a.jsx)(l.nA,{className:"px-4 py-3 text-gray-500 text-theme-sm dark:text-gray-400",children:e.phone_number}),(0,a.jsx)(l.nA,{className:"px-4 py-3 text-gray-500 text-theme-sm dark:text-gray-400",children:e.address}),(0,a.jsx)(l.nA,{className:"px-4 py-3 text-gray-500 text-start text-theme-sm dark:text-gray-400",children:(0,b.R)(e.createdAt)}),(0,a.jsx)(l.nA,{className:"px-4 py-3 text-gray-500 text-theme-sm dark:text-gray-400",children:(0,b.R)(e.updatedAt)}),(0,a.jsx)(l.nA,{className:"px-4 py-3 text-gray-500 text-theme-sm dark:text-gray-400",children:" Đang cập nhật "}),(0,a.jsx)(l.nA,{className:"px-4 py-3 text-theme-sm dark:text-gray-400 text-center text-white",children:Object.entries(h.Z.order_status).map(t=>{let[r,n]=t;return e.status==r?(0,a.jsx)("div",{className:"text-white bg-green-500",children:n},r):null})}),(0,a.jsx)(l.nA,{className:"px-4 py-3 text-gray-500 text-theme-sm dark:text-gray-400 relative",children:(0,a.jsxs)("div",{className:"flex justify-center items-center gap-2",children:[(0,a.jsxs)("div",{className:"relative inline-block text-left",children:[(0,a.jsx)("button",{onClick:()=>O(e._id),type:"button",className:"inline-flex justify-center w-full rounded-md bg-blue-700 px-4 py-2 text-sm font-medium text-white hover:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-blue-500",children:"Sửa trạng th\xe1i"}),L===e._id&&(0,a.jsx)("div",{className:"absolute right-0 z-20 mt-2 w-40 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none",ref:t=>{R.current[e._id]=t},children:(0,a.jsx)("div",{className:"py-1",children:Object.entries(h.Z.order_status).map(t=>{let[r,n]=t;return(0,a.jsx)("button",{onClick:()=>Z({status:r,id:e._id}),className:"block w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-100",children:n},r)})})})]}),(0,a.jsx)("button",{onClick:()=>M(e._id),type:"button",className:"text-white bg-red-700 hover:bg-red-800 focus:ring-4 focus:ring-red-300 font-medium rounded-lg text-sm px-4 py-2 dark:bg-red-600 dark:hover:bg-red-700 focus:outline-none dark:focus:ring-red-800",children:"X\xf3a"})]})})]},t))})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between p-5",children:[(0,a.jsxs)("select",{name:"pageSize",value:T.pageSize,onChange:e=>{let t=Number(e.target.value);E(e=>({...e,pageSize:t,page:1}))},className:"h-10 w-30 appearance-none rounded-lg border border-gray-300 px-4 py-1",children:[(0,a.jsx)("option",{value:"10",children:"10 / page"}),(0,a.jsx)("option",{value:"20",children:"20 / page"}),(0,a.jsx)("option",{value:"50",children:"50 / page"}),(0,a.jsx)("option",{value:"100",children:"100 / page"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-4",children:[(0,a.jsx)("button",{onClick:()=>E(e=>({...e,page:Math.max(e.page-1,1)})),disabled:1===T.page,className:"px-3 py-1 border rounded disabled:opacity-50",children:"← Trước"}),Array.from({length:D},(e,t)=>(0,a.jsx)("button",{onClick:()=>E(e=>({...e,page:t+1})),className:"px-3 py-1 border rounded ".concat(T.page===t+1?"bg-blue-500 text-white":""),children:t+1},t)),(0,a.jsx)("button",{onClick:()=>E(e=>({...e,page:Math.min(e.page+1,D)})),disabled:T.page===D,className:"px-3 py-1 border rounded disabled:opacity-50",children:"Sau →"})]})]})]})})]})})}let j=()=>(0,a.jsx)("div",{children:(0,a.jsx)(f,{})})}},e=>{var t=t=>e(e.s=t);e.O(0,[474,49,464,688,623,805,441,684,358],()=>t(5642)),_N_E=e.O()}]);